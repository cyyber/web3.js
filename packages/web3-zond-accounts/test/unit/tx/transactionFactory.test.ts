/*
This file is part of web3.js.

web3.js is free software: you can redistribute it and/or modify
it under the terms of the GNU Lesser General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

web3.js is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU Lesser General Public License for more details.

You should have received a copy of the GNU Lesser General Public License
along with web3.js.  If not, see <http://www.gnu.org/licenses/>.
*/
import { hexToBytes } from '@theqrl/web3-utils';
import { Chain, Common, Hardfork } from '../../../src/common';

import {
	AccessListEIP2930Transaction,
	FeeMarketEIP1559Transaction,
	Transaction,
	TransactionFactory,
} from '../../../src';

const common = new Common({
	chain: Chain.Mainnet,
	hardfork: Hardfork.London,
});

const secretKey = hexToBytes('70c89ad9f426a06f6039eaafda70942e115ad7c03105e62032cb943029819da76e3d3574928b310c6406bf6df47301320efcb390afec8f74ad3e775c86569a3a1e1dd3fa39d1f3bf8b0464246a69a1f6fa1d042b0425f00220908cb4726939bf9cb46c220524cc042051340a0a464801b589994851c0a46d1934081bb2649204301a374461324c09092e4a928500b3300948509a104d190228cc345109824810c828ca108e20a98ca342849b368ed8a40d03076c18863052468de022311a2066482264800064600626cc344564122501944801396e10378403b43158384edc3212a0c69081006202c70d14b86948342e924612414801db924c12b08953a69098b64811150a20a2418c324261300c1117808c186e0c258298380e1108451c278e04a78161824ca08684d84205818285cb40211bc02841122924c105214880e3066611350009371140a49089148921122a031841a382250c458842022c21499299167242a47018c7295c480013272621122e0c9928c9446d42942554906c894602c11268d3a66502990d4cb429d0086640422c2490610a282e1436510aa88413376c0c116950342e13008c039320d9c2116312818c442988406d84a45119c7894ac229404286db8280dc422c04b19151b4709cb8491b3500929650e4020c09140d59a24c019385591052c0462262104e64b845c3c81053b68011380a1b3145012700194125cbb86dd4a0645892810ca0858c344618332982b084c24289d838211c062c22462d62b64cca4685a382856348509a42848244860035021b364524080d8b28312044626416458b944823346e94002a024050cca468824431208740001562ca261142306901a1458440600098701b3405d0228049b64440120d14126e2316651a132d0b904101272aa39040d3226604080021164903210912b12989a05184c6889bc888e1024402892c53108604125053a40520b14481243161346de4048a24466da34290c21480e41800e1946c00820c99a00194048942244023329003b24da0282653c6215c802d1b23408b202e01156a140986cb840802a1891844020a03446200110aa709d9c66ddb34290b1150da14801c896c0401648c246e098360c124481948251444101aa820d4362581020588a28dc1b68909346c0cc58c81962189c0205c8631c940012402628842505b122003226298b62008c76d21447121302490485221a4451044121a222d2330710c4062d0468ca1408800b741ca3891010028d1363112a440028629620851114285d34884db080e193029528045a0826d24220d10a0851c310a93481224380500c711089828000622094405c046505b04908bc08409446d82349114a941881410e2c829022872848605c1c6481b2408243004daa470a3b064d8a84588320423992104304e203481c290804ba47143106e184372019381992691d420298316114986810bb1104b3849183452142660d8407042889182a424a182211cc285a4a051cb1431cc18520bc88c848010813226192701619865caa22564360848486a49a29059282150446822b530e0088e0912460a408588c471d1042d58a0081a407293448d10b405011310e210495c884823b40108b98c02286c1bc61098386a5226225082451b390e14230a80b6800bb55122040408a011921684248705109405049204cb80892199618482644b2429dcb80401010992342c9c1808d314912286409b060e01b825218990049120c8c410a3108c01c970c12092194448e3b62cc41648d4285223218e003744043360c8b20002308a44384612448e11c1880cb841a14800182972d8484621016598922010044558344604c9298c987114a15024260c0938411bc13004352d8aa62d48369098185093c29124978512b16559c84d023580211311443481e38844232269da4431d9a80989460918283250088644c2409292854b822c220046c9168620018263026e09224a0bc15081980c4b086961048524242841806cdca02903a7091b408ea3340c20a041d9242cd8107111400d5cc024d4900d53b46892084664160a4b042089166188924dda480652a625033641c3b82cc914286212225b40059a24724c026d4ac204a0244591244d01a24c99b64c48320d203910c4202492369290324a1eafd3362724fffd18996584504588b6f4e59248d4f83795dd144c338e32bdc4f21c24bbbfc9082e96cb07f45b61812e4aad6612d61a7aef6f97511988d4943c05b569de86708d1170cdba6944aab3ce0a9bbbee510c7869979099237063c516172d053cb94ab9858a3d28fa7ce4026bc23298b77ad1d4a2d61bcd942964cd8bd1943709bf194e91567fa5e211e752eda0d4c39a2894176fcdcfaea21145451476a605d43b357dcfc1ea9997074d986ac8dda6e83e002644faf92163869d085d636679ce15f35cbd90b2aeb8bfc087d14126303c00eb1891f5439665aae3e6fbd072e1360af300f366f7834e9ac0e2cc388b3e947e662aa94a8ae14f3ec4618f99503d75e78a36e742a2e6b3477b10d511ae32238efbb7054e5fc0cbbc45562778305fb755a8774cb51b50a0dc11ccc5491587779d0a7b8214f3041bc922832e8b94d33042c3203ff7a59974cb674e4bc8baae835c154900f0e2cf7bbde23bda0710759278f6697b1a31ba5be35077aaad690eb5f3dca5e39aa591eb4ff90ac0a65de42068e509a7a2a877ac8a90fd67c58e8ef9f075dfef04a12c2f9a0cf44b8b2271b164a5a8045c3e7e71a8f7235ac6f8dea8551a21529484c7fc290082bdd4cf1773a5c93d5933b734e5e7c910fdf2c8361746c6a26a0b43f3c613f2e80b0af97c5cc63971eedd3362a9c253902506d1d5fc12cdb35e3d706c3a92f61491d32bdefe2b932c70570a0502a935bb78491f7f7e7a262e788bbafa49fd9a1e40f6842e11a21b656add5729d3e70161ed36900775017ea9a28ac8525672a966be81e36534eb5d77bed4dfe369907695e7d3d8705f6f15c27b2e530993a3869d3a7bbaa4d18454b731c25e7f1515452c52a2c393348c6ad46a522c07a7c7c1ff3b2895d398fa579cb13ca9d2ec464da539e217297969e79fb20627d3eeb933348c8f559c6dec9c55be65a4a534662483a72a449c99d27a5b94d8527b6561f2b4edde938fa4a3c8adfcff7ef96db7aff371669de730548a5f7d4ca6d6cd22bad4a5ccdca4a2ea3a9ab38692fa093978c1b79ea151264f0af55ee802cd0917d1ce92ca4d14ce7e92db46886b9517fc4390ca950e12c4228efab621ec1e50b28773591d25a0e994fd68177cd188043c3c186aa9e91c50abe86669e5743e1bfa7b77fa2e0d8ce11d7957f1e6f940c68d601efbc71a907b25c3265ae139d0b2d6017782c9a8062db29a3388cec9c96ab7f4f5151ded97fa41eb482231d71025cd0e336dced2275fb415177ff617cfe5caa0f5a6bc74fd6930710886e7289a26e1a3bfce7d7d8fc74fd45bec542d063b3a2445ee00ff463284db9dcd2acf9728619bbf25bd5685fa87d47e5c2cbeb824aeffaa0e77b503279a7ebd6d4f44c2badd3404d6c131b44053921a4b4af23c2116d943e1057aef25a5677743a9011057d51fea3b8e83f41cb87cc1b7c039a6ec88f40399308e090acd41efacb692d1a23bdf517dd6a08338c629e7ec3c132ed31c64e53559564c05ee5f27a0b56711c4c5180b44f904139529aa76b0cb3ec32bb822827c881140e273f5b815898210f1dbb49546f971553833d1dfc380f948b1fa1245b71a91c2510b9dd48433ae2091156549275fbe42e0047c55bdaf9ee051829e81afa87e4fd9831fbaa30d19fe289ac426bc6de867dc3c2eed86282cd0053cfba0a1c8bd04c007c14be320da03a0bb1b6d89540f3432a4e5c38af188d1c802ea49df9e893e4d2484477c0fc4a49c15ca32aecc4e35276383e50494779ce44abe3feb5b5a1bbfb03ce951d69fb874b7a6914786dd950d1bf4f049f47b9f2d1f03b63c64f99b21847f3173a5c1e06d544ff14e443b4c2383df854c494d4607e851a3467fffb4df3a1911a2d7862bd38907c7612b3e69e8b8913f689bf0c169a90a70c42683b5dc065693f1a9acd87f86adcee556e3c41ea0733779cdd24ddc43bf9ff0c3bc89edb2d11b79a0ebeec0c1e192417fea18d434914db4667411177c5a50933722a386dab514a91d5074a9f66bdcd9d7ab18cc0986688807578e6275186b589361e67ecc84da15f852f08d8ecc7e2041fd7e9d303f21607145c62c01caa8b8f9c33da53e6dd3aa36fc7238a0818afd97536892bc266c62e7821bfa20d3b3a168bfb2cacc19161535308634e67aad66408f5d4a8d3c523e389713fd712a3a77d6b1399587931a7ff0c1f8d9ada1d6673ef7795a9acae63bf8e283b4d4669ce1a0b036ee24a8f5d4282646d56300edd076af994fd904fa1c0194ff79f2e4671c23b9a4be84a7ede66f960b1920fa85a14a7d2b39f1aa455ee432050fa8302285babddd052401a15a67b5385752176abad7c414b2c0b841347a9f64b57ae8bd98b54cc67902716700c8ea31c9ce1d496d071014270b5f8c2c28d170744bd3e7800e8b6dd6e555f4b3479460b6bcc98627d03a48274d5a0d3c2d2883caecfa3ce232c0e3531dcbf0864d462f2e0870980511436dfa51662edb30c24e90e85f576a250ee266103078420fb65d6c44ddd2242b5362cf4de40396c005cc36c534aafb4604eeda1a6f73f4be23ced6a592a0cfafd9d51c8ef579d18ef8faa8bf4d9fbb12c7a560bba3e4583190bd2296f51e36b93916f98bdbcb5e0ca38cd2741bdd30a8cd42669fb6bea1c6bdb341513e1f476cf1bd006f1f7de7174f47f5bf4dda88b1f40ea7dde687e38ee61e27c7c0bb0b07c65648b9b54c948eda0696aa8fba6faf675e77b984b24c5e243020a28e41f40f2fff49b5b7e1ec81e95398d0fc23d847037f54fe895c2ed96f6f30b20048c6c43765f90680f6cfc645bfee38d84755b3d8f92559bc6af4cb29b47119a7fcbe823e5d3d8e7c221510ab468b7d23257bb482a659acd71a7fffa552b3649dcf1d4ca358e5e4f451d0afcdb36aebb7f90f04b9c39b08954044bca8b0fdd1973ec40de029eb8c2ebe29d0576ce420a2aec3cca42fdaf7c9587eb29d29ece52785c53a1a804363c36302b3255a3d06f9a971d9e8128971ac06501d5d7bb5d25fde5008cc10c508ab98e989bc7bb8223d4834bf3ed457a8cab3a9a80632c2a2265d3dd86f09c01469405df4e9228a708e9824cb33f0ad7612c570907fb83c371198e287fc63dd7d25e5b8c884b134883ea943d8fc54f925073b9352591d0100d5821fb855c1ef7092f0e12f86421f9ddfc59dd2d9f5c5881e569aaa58281d591e21be1f56b1145ee078c3d1f72dc04938947001c3b3b3ac281382f482fad1ecd081d9c493457451b5f38bd2e200a0a6038a8cf608cba3e64dd3b48fb2feeb1c3f807b4b376f019ddd7ff5be2f7973fea4318010f7f31876eef12a8b7b92ebc3aa2cb83508ab33250cd148176b2388d4724fc8b0ce4b9d67fee944de2590c28c304b19324129dad60836ed1efbba140393546a8b2b5531a7c8a590256039fd4591a38a7af9d6073d024425caa1e18031e6041e12020b737f6bbe57a98b7557cd12fcd6bd42ffd7707dc177701043cb160c3b411d16b131c1f99bb0accfaa3b7b222980f33c96de48e6c006d8e77c5ba9d877c5b4f9412c187a7ea6dc07f73585688dfc559e4cf36e8e267779bd42f93130a1f33563d8321f51195e9e4a47d7f3a82534b1f0d8ec517a38a12157fc65041e9b03a8f9c0d6aca6f4ec1fc6e961f048d809d268dab420873412e0f37bbeb67d07b718509d99b1894305d7562697904c0eeacba4adc496ebc98ddb2388d9e118d5aa9fd5b21c6212742a07e8bb5ee484bc8e271c613d81143f264c36aa6c2cdcdc0fefa0107cdc8f1e186524b427867ab6a17a776aa32ad898c3d0c80a548e025ce014dfeb0d159f37957971bfde5438eaa2798c7f1b72b32456892b30c1d28b77276c0df4e70630371c42f8b9345ad994b7a11e57565f99bc6845ce1664291f083185907537c6fd85514f9e141c21252c49d071cdfb2a8b984cc0b8dd2b72490a47dea5884a8e027d41c05087ad57fcb08f81ba321bfa6b3c99c6f39d6e25dd06262f7e978e2938143f597c13500c8f6ec8519ea8d75063dc1795355107ac2f21c7c8a2077d2ecac6e6b2cbfdf6f09d03a3a51fec1c8225525e3d4a0c14bccfea14c6146c7413c4abd8886aa5ea756fdeac7029fe1812a68eb0bc908f8f9980842f5305dcc8c9a3945e1a653e5694b11aafe6ea1500805f9242fa339ca9a465fda40e56cd20ec168f71547657a55e4d0402aca0407fd42cc3e1a42c5e379088ce7d992efd6205e5aa6707e7442628368484f489297d12424112a4e367e25bfd2ca2ffaf816eae19bfe4e41a83378f93d4ecf21147d25b405da4108a7b1065d744281ec78aa569e25cb39503b631d074d471eeb83c54bc9a14977ad6f7336b2a226dc7eeb5c8999bd5a7c07488fb0c3990f80f6fe04bd8571f1d55767838e9824159f84b22caf3c6fc554e9924b4f88b2393dafd14090aa0463de066c83e5c7c4ba727a90e22611d58f82f5ba531d3d6d83c67e75ebcf2dd722d9db169f56a969d694b21b429121be99b764da5135e68a70f032e29dca8cad93b58fb315c658d11c2c557ccf0dde4af6feba53f8dd751f285c54944b57a2e2e5210bbdaec313085de49c50da2fc6d13329f5d2352486d85733607ef967def0e94e0323732c1db4b595a9d6a14c7385a57096c20a0ac0fbde5b733e28c493386936076dc9c34e6e31b18a4faf5a118d33a1f6a2cb9ace8333c');
const publicKey = hexToBytes('70c89ad9f426a06f6039eaafda70942e115ad7c03105e62032cb943029819da7a7f70ee6adc76e3a98c6a94f1f81939ac93f68dc6b18cdb589015f9df335ddf5fbe619edd232b682b18f3058112e1e6b61a2c4b9c1a0f74fee1e219617165a7571799a2645a0cad786313e1a256750acaaf9c6df99460162db5da4be0fe9db6ec36837f9e8df74bbb6194892f5f8d3b8edeb3b9bc597d3851a07842f5d46165df78eed6eea32d5b70d3df27ec4e98c578c7dd94ea5f393f6aa43b9eca412671b52b9222c95ce5dfaef4366370b78ed9d4ed788d47ed5ea4cdad63d82aa3c3269648e64741b7badda7a144cf7cd3fad793e700573b590bd4ff82a9b1842cd86dbb27a238f02b7e012d1609c1a0daa5e155cde293592a1eb0b76ba3e30daab7851de16cfd04ca92efa5d125eb30819a65537d005d0ba6253a187d2a12c4d8368e95acf74f65ed5fe797fb13171e49877fb2a1f5e022918ab2139fae8cd970e3ae62a68aa2e1761ac7ec77c89ab8720f1940979ffbf2396526a3d8a1a16e0bcc23d605b43acadf2ae169e1954a87f48f7a7fcac1a60b70e13525eb133090a0322fa46e482679c1bc1d16a62b591caf37159b726b395749d5fcc3bf157c6bd6701591c8e2ae7d0762ba801367be2a001bfdd99e60c598ccb7cf6e0c7bc41264b268068758b9d0d70d7a3a1a340b95b0e28bbebf2fb4c88a4a4afbd473722319d02d658f8085b8d3d61a7a3994e16cafdfcc962afc1ad3aeeb99b7b5007f78c869cb5826fe474683be69756885682a85713d5ab1e961478d018619e559eb825f9b5038c843b1cb52826067bba53d17e3dcdb3d2bceade05be74a1211dbb45f25c63fbf21d4cfc939feede8b3701522c65cff351336e6b79c56182c4fb84db7f011a1f9c93f626128064cb3197eddd03035fb84fdb7b819668270502013b183a527e1295110b37ba9a7bbb8f72da499549a3c02fc8849226353ea2ae3423e8d3ccc6f43a4352baca6347c6fa5a11bf65877dd8a890ddead5a8116a2068aa4409e459f8d9f96b6c9dfecc64dcfc47061e9e2ceaaf17510de01450975d53017b5b3053dfc5b7b85e6a42107c10e7bfe9a492395451211a746b1daeef322227df21b59fecff66694f022d9efc078cebef1ab149837c8428172cec2ebe46459faa5212b6a41ef5df4866b94075e79dc12e01850b1ef1d3235cca329828d44c45cf374bf74cd3a72bdb809aba1b553719bd981e7a9dd9122ea59acc119228716b786d597a5a57b70cf624e84153a3cb38bb32cce797cd6a3d1b46daa9c64004a169df66aa5e4a74d2d4f6ffb999865238674438b4859fa7afa05192ea6bad91f472c8a801c73bc1acd93e22c746d79d0e601a0fc200269a99715b8bc506c746abc7e07df882f27d8e4d9f52b276d74f4630a25c7248bfa2d8ef91f7f75f870fcb7efb63ad4313cd6aa9c8675460121b2fdfa098c3fae44d099d2dfda28418171aac84e25e5d16ba5c9bb783a9060986f2426b40a22b9816cbba7819cbf613c61cf7dbc082ea7f00deeab9b0466ed9aaadba6829e0ed17e9d3f9e233c448f8d4a8a6c6230d1bf64a52c6e20a5e2e8ef06f0a4cc530a4992fea67b75583c66848215e8971093f13ea586f8976abc7dd1fbc7aea8685ff0e10d7291453b83ace4b50b38a91b768efc05a37223eef5b2c6fa09cc6b607348cc5f2572d09cc4142f3db35c50f3faa11bf5822f12886f929c6318c634cee7aad539e0c188fa63008c1f67d3c4a10a791ff567d7f4055200994b058af5859bc77ddc77865e6ad9063e341cc71b846b27677c827b70982792d7c34d0fbecc5b9356c61964fb3444851b8fa72b94fba7a26b9b0be2f7a0d9f1aba832ab54a61598070a222961855cee2899f7060194ac244de75df0c1b420ff8f4ec4c3e085b3055d96028e836ed9d0d9884ae819c919dca7054f1675c06c73551f8fd48496e333903824bc7714abfec16729c4f7b1e8b4bbda43fbd17f5b077a2898031ac74b62fe2ee71507401f076fa1b3a2e4530735f42e3f009c4367aec629e43664bb2b3c802f963e545b36436003dbccb3015741f8e954d7f4fe1b6462a3319220c028a662ce8e41783d3cda1d76cce69f46f9a7a944daedb36c13c86c72567f84fc2b06a03fded8f28952f88ae15bd098980111fc134cb50f206f587ec24e3150a36793346ed936c164d89fe5e3acb0cc8d6100d3c21c06d3c51fad8c53ce150f6def7f8421d3b26733f037c3347a84226cfa218f163988220dbdb83fb05d8bab4ee76bb3fddce31b3e731dd3bf34bf87d6333157e1df0ff784f390e4762a1056e9afe82d385b8800cda51329681837148ce564553f51b6b2150ef589af8762fcb3de90734540757dee6ca7b7430d8b8baa3531ce3ae885a9327961a1688eb476fc66409d235bd78a92d4fd7fbf882d6de0417daa0b45bc7e650984b0430e94943b292b47329ed79299a9fce2293430077caf2aeb0e0c5ac3036a650568ed087c4d20a62ef31d109e6027031313bc34e4b4c2a3bc9927ad119ea0ddddaf75448fe29237ec757560440bc1337d3704bef265fb3b131dc63012f4717314451b6de8ead2490a00c2da7aa72f07aa4370a177bf20e81794922dae06014c26f344c783647ece59defcbdc75cef2f86c1452497f9bf29d3b80faff2551a768cd8cac896b57f7e16f85a50695f29570d186c2729d694f6d71a729a6317d2bdf43e6a4a279fb2ec52ce3f38c4942f10713c51c78ef2f440124f870c79e6e5273cb6f725d1ee8e64f0d366c0ec886b75b3b01d8b2a5ecc78c9f46709b98d3a3bb3b650edfb77e8eea6ef6303ec49d75bf9270edb100b4ba67e5436b0651185b4392d763b73743868d2911a66fe6e9affe443a0d911ca5966003331d2f40ea2ba99242f448c4138f56b304ba77b1a333cfdba20dbabe8655488e55cbe6c8d4cb367bc5fbf0e1928e8d863e27e47cfbb736b9819d1b65e2b351391e85296a33a29fa34de28a511a14e78c829af3c88d867afd7a654c9c17b2d37dbe11c208935a3349f6046b06106e63998f9fa19283b210a8105506a1f356192f28811ff9caf250b18b61b994252b2b30e37b9ae908f975d7e95f36abe3f5ea86ff699c2933ff3badec2589b0af3637d74d00539ea3084e9ba2f1735d3be70d2729801586a3a3765d533d9e7b2ba2338c9480effbc55c986a10ac358d3c29e3b3d995a13de49d670f6bd2ea644ab921536f8c2f0b88e63a58dca6f637ef1fae39a1a43c1c9c745f236e10250dc65f9a0261a7e3554bb693d7e3a351a080a33ec5c027b21fb3299b760a03da171cacdd05b67b2cf750dc9009db659e7222904f52406d8e001045fabc4f006611fa02b8cd0c1ae2d6f19d03f05d0d1c7f98f92a95275b2d07633de4c9924cc84206904392b7f0b10b045212435a6e9cae7d9708b86dbe2bc7e80aef7e43cdc3ecd70331d6de9ef0daa3e0794e6cd3000115c978e77934f85d4dc3adb364f4265fe20ca19990ec6975f44e25ae38acc89c14966858d2859501dfadcc09f599a0987eadf68b1e8d9068d0a66724bc8f79f497fee2867c7638cc902263145cc74ec2ef251480093d9876bac78afbb72fc094ba16e2f44be6c412c27d93891f707558d6636dbb00dbf34dba1ad3b01cb545351e84');

const unsignedTx = Transaction.fromTxData({});
const signedTx = unsignedTx.sign(secretKey, publicKey);

const unsignedEIP2930Tx = AccessListEIP2930Transaction.fromTxData(
	{ chainId: BigInt(1) },
	{ common },
);
const signedEIP2930Tx = unsignedEIP2930Tx.sign(secretKey, publicKey);

const unsignedEIP1559Tx = FeeMarketEIP1559Transaction.fromTxData(
	{ chainId: BigInt(1) },
	{ common },
);
const signedEIP1559Tx = unsignedEIP1559Tx.sign(secretKey, publicKey);

const txTypes = [
	{
		class: Transaction,
		name: 'Transaction',
		unsigned: unsignedTx,
		signed: signedTx,
		eip2718: false,
		type: 0,
	},
	{
		class: AccessListEIP2930Transaction,
		name: 'AccessListEIP2930Transaction',
		unsigned: unsignedEIP2930Tx,
		signed: signedEIP2930Tx,
		eip2718: true,
		type: 1,
	},
	{
		class: FeeMarketEIP1559Transaction,
		name: 'FeeMarketEIP1559Transaction',
		unsigned: unsignedEIP1559Tx,
		signed: signedEIP1559Tx,
		eip2718: true,
		type: 2,
	},
];

describe('[TransactionFactory]: Basic functions', () => {
	it('fromSerializedData() -> success cases', () => {
		for (const txType of txTypes) {
			const serialized = txType.unsigned.serialize();
			const factoryTx = TransactionFactory.fromSerializedData(serialized, { common });
			expect(factoryTx.constructor.name).toEqual(txType.class.name);
		}
	});

	it('fromSerializedData() -> error cases', () => {
		for (const txType of txTypes) {
			if (!txType.eip2718) {
				continue;
			}
			const unsupportedCommon = new Common({
				chain: Chain.Mainnet,
				hardfork: Hardfork.Istanbul,
			});
			expect(() => {
				TransactionFactory.fromSerializedData(txType.unsigned.serialize(), {
					common: unsupportedCommon,
				});
			}).toThrow();

			expect(() => {
				const serialized = txType.unsigned.serialize();
				serialized[0] = 99; // edit the transaction type
				TransactionFactory.fromSerializedData(serialized, { common });
			}).toThrow();
		}
	});

	it('fromBlockBodyData() -> success cases', () => {
		for (const txType of txTypes) {
			let rawTx;
			if (txType.eip2718) {
				rawTx = txType.signed.serialize();
			} else {
				rawTx = txType.signed.raw() as Uint8Array[];
			}
			const tx = TransactionFactory.fromBlockBodyData(rawTx, { common });
			expect(tx.constructor.name).toEqual(txType.name);
			expect(txType.eip2718 ? tx.serialize() : tx.raw()).toEqual(rawTx);
		}
	});

	it('fromTxData() -> success cases', () => {
		for (const txType of txTypes) {
			const tx = TransactionFactory.fromTxData({ type: txType.type }, { common });
			expect(tx.constructor.name).toEqual(txType.class.name);
			if (txType.eip2718) {
				continue;
			}
			const _tx = TransactionFactory.fromTxData({});
			expect(_tx.constructor.name).toEqual(txType.class.name);
		}
	});

	it('fromTxData() -> error cases', () => {
		const unsupportedCommon = new Common({ chain: Chain.Mainnet, hardfork: Hardfork.Istanbul });
		expect(() => {
			TransactionFactory.fromTxData({ type: 1 }, { common: unsupportedCommon });
		}).toThrow();

		expect(() => {
			TransactionFactory.fromTxData({ type: 999 });
		}).toThrow();

		expect(() => {
			TransactionFactory.fromTxData({ value: BigInt('-100') });
		}).toThrow();
	});
});
